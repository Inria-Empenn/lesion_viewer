<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head>
    <!-- <base href="lesion_viewer/"> -->
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/site.webmanifest">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- <script src="libs/jszip/dist/jszip.min.js"></script> -->
    <script src="libs/jszip.min.js"></script>

    <!-- <link rel="stylesheet" type="text/css" href="libs/Papaya/release/current/standard/papaya.css" /> -->
    <link rel="stylesheet" type="text/css" href="libs/papaya.css" />
    <link rel="stylesheet" type="text/css" href="styles.css" />



    <!-- <script src='https://cdn.plot.ly/plotly-2.4.2.min.js'></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/danfojs@0.3.3/lib/bundle.min.js"></script> -->

    <!-- <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.noStyle.js"></script> -->
    <!-- <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-grid.css"> -->
    <!-- <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-theme-alpine.css"> -->

    <script src="libs/agGrid/ag-grid-community.min.noStyle.js"></script>
    <link rel="stylesheet" href="libs/agGrid/ag-grid.css">
    <link rel="stylesheet" href="libs/agGrid/ag-theme-alpine.css">
    
    <!-- <script src="libs/lz-string.min.js"></script> -->

    <!-- <script type="text/javascript" src="libs/Papaya/release/current/standard/papaya.js"></script> -->
    <!-- <script type="text/javascript" src="libs/papaya.js"></script> -->
    <!-- JS debug start -->
    
    <script type="text/javascript" src="libs/Papaya/src/js/data/sample-image.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/data/talairach-atlas-image.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/data/talairach-atlas.js"></script>

    <script type="text/javascript" src="libs/Papaya/lib/base64-binary.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/bowser.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/daikon.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/nifti-reader.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/jquery.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/numerics.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/pako-inflate.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/gl-matrix.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/gifti-reader.js"></script>
    <script type="text/javascript" src="libs/Papaya/lib/GLU.js"></script>

    <script type="text/javascript" src="libs/Papaya/src/js/constants.js"></script>

    <script type="text/javascript" src="libs/Papaya/src/js/utilities/array-utils.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/utilities/math-utils.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/utilities/object-utils.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/utilities/platform-utils.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/utilities/string-utils.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/utilities/url-utils.js"></script>

    <script type="text/javascript" src="libs/Papaya/src/js/core/coordinate.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/core/point.js"></script>

    <script type="text/javascript" src="libs/Papaya/src/js/volume/header.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/imagedata.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/imagedescription.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/imagedimensions.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/imagerange.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/imagetype.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/nifti/header-nifti.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/dicom/header-dicom.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/orientation.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/transform.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/volume.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/voxeldimensions.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/volume/voxelvalue.js"></script>

    <script type="text/javascript" src="libs/Papaya/src/js/surface/surface.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/surface/surface-gifti.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/surface/surface-mango.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/surface/surface-vtk.js"></script>

    <script type="text/javascript" src="libs/Papaya/src/js/ui/dialog.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/menu.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/menuitem.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/menuitemcheckbox.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/menuitemradiobutton.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/menuitemfilechooser.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/menuitemrange.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/menuitemslider.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/menuitemspacer.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/ui/toolbar.js"></script>

    <script type="text/javascript" src="libs/Papaya/src/js/viewer/atlas.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/viewer/colortable.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/viewer/display.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/viewer/preferences.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/viewer/screenslice.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/viewer/screensurface.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/viewer/screenvol.js"></script>
    <script type="text/javascript" src="libs/Papaya/src/js/viewer/viewer.js"></script>

    <script type="text/javascript" src="libs/Papaya/src/js/main.js"></script>  
   


    <!-- JS debug end-->
    <!-- 
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    
    <py-env>
    - numpy
    - SimpleITK==2.2.0
    </py-env> -->

    <script type="text/javascript" src="main.js"></script>

    <!-- <script src="http://127.0.0.1/shared/jquery.js" type="text/javascript"></script>
    <script src="http://127.0.0.1/shared/shiny.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="http://127.0.0.1/shared/shiny.css"/> -->
    <!-- <py-script>
        import numpy as np
        import SimpleITK as sitk

        viewer_container = document.getElementById('viewer-container')
        # listen watershed image event
        # viewer_container.addEventListener('watershed-image', function(e) {
    </py-script> -->

    <title>Lesion Viewer</title>
</head>

<body id="lesion-viewer-body">

    <div id="lesion-viewer-container">

        <div id="viewer-container" class="hide">

            <div id="papaya-toolbox-container">

                <div id="papaya-containers" class="row">

                    <div id="papaya-container0">
                        <div class="papaya"></div>
                    </div>
                    <div id="papaya-container1">
                        <div class="papaya"></div>
                    </div>

                </div>

                <div id="toolbox">
                    
                    <!--                     
                    <div id="level-sliders" class="lv-col">

                        <label>Image levels:</label>
                        
                        <div class="lv-row">
                            <label for="threshold_level_min">Min intensity:</label>
                            <input type="number" id="threshold_level_min" step="10" class="slider" name="level-min">
                        </div>
                        
                        <div class="lv-row">
                            <label for="threshold_level_max">Max intensity:</label>
                            <input type="number" id="threshold_level_max" step="10" class="slider" name="level-max">
                        </div>
                        
                        <button id="reset_levels">Reset levels</button>
                    </div> -->

                    <button id="side-by-side">Toggle side by side</button>

                    <div id="toggle-visibility-buttons">
                    </div>
                    <button id="go-to-lesion">Go to current lesion</button>
                    <button id="toggle-crosshairs">Toggle Crosshairs</button>
                    
                    <div id="draw_tools">
                            
                        <div class="lv-row hide" id="draw_3D_checkboxes">
                            <div class="checkbox">
                                <input type="checkbox" id="fill3D" name="fill3D">
                                <label for="fill3D">Fill 3D</label>
                            </div>
                            <div class="checkbox">
                                <input type="checkbox" id="draw3D" name="draw3D">
                                <label for="draw3D">Draw 3D</label>
                            </div>

                        </div>
                        <div class="lv-row">

                            <button id="fill" class="tool hide">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 9.4C53.9-3.1 74.1-3.1 86.6 9.4L168 90.7l53.1-53.1c28.1-28.1 73.7-28.1 101.8 0L474.3 189.1c28.1 28.1 28.1 73.7 0 101.8L283.9 481.4c-37.5 37.5-98.3 37.5-135.8 0L30.6 363.9c-37.5-37.5-37.5-98.3 0-135.8L122.7 136 41.4 54.6c-12.5-12.5-12.5-32.8 0-45.3zm176 221.3L168 181.3 75.9 273.4c-4.2 4.2-7 9.3-8.4 14.6H386.7l42.3-42.3c3.1-3.1 3.1-8.2 0-11.3L277.7 82.9c-3.1-3.1-8.2-3.1-11.3 0L213.3 136l49.4 49.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0zM512 512c-35.3 0-64-28.7-64-64c0-25.2 32.6-79.6 51.2-108.7c6-9.4 19.5-9.4 25.5 0C543.4 368.4 576 422.8 576 448c0 35.3-28.7 64-64 64z"/></svg>
                                <span>Fill</span>
                            </button>

                            <button id="draw" class="tool">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"/></svg>
                                <span>Select lesion</span>
                            </button>
                        </div>
                        
                        <div class="slider hide" id="brush_value_container">
                            <label id="label_brush_value">Label:</label>
                            <input type="number" id="brush_value" min="0" max="255" step="1" name="brush_value" value="1">
                        </div>

                        <div class="slider hide" id="brush_size">
                            <input type="range" id="slider_brush_size" min="1" max="5" step="1" value="1" class="slider" name="brush_size">
                            <label id="label_brush_size">1</label>
                        </div>

                        <!-- <button id="undo">Undo</button>
                        <button id="redo">Redo</button> -->

                        <button id="save_segmentation" class="hide">Save segmentation</button>
                    </div>

                    <div id="info" class="hide">
                        <div id="description"></div>

                        <div id="fields"></div>

                        <div class="validation checkbox">
                            <label for="valid_value">Valid</label>
                            <input type="checkbox" name="valid" id="valid_value">
                        </div>

                        <div class="comment-container">
                            <label for="comment_value">Comment</label>
                            <textarea type="text" id="comment_value"></textarea>
                        </div>

                    </div>

                    <div class="navigation">
                        <button id="prev">&#60; Prev</button> <button id="next">Next &#62;</button>
                    </div>

                    <button id="save_task">Save task</button>

                </div>


            </div>

            <div id="plot_div" class="ag-theme-alpine" style="height: 600px; width:100%;"></div>

        </div>

        <div id='load buttons'>

            <form action="">
                <label for="lname">Nom:</label><br>
                <input type="text" id="lname" name="lname" value=""><br><br>
                <label for="fname">Prénom:</label><br>
                <input type="text" id="fname" name="fname" value=""><br>
            </form> 

            <div>
                <label for="load_images_archive">Open images archive:</label> <input type=file id="load_images_archive"
                    accept="application/zip" onclick="this.value=null;">
                or
                <label for="load_images">Open images:</label> <input type=file multiple id="load_images"
                    accept="application/gzip" onclick="this.value=null;">
            </div>

            <!-- <div><label for="load_lesions_data">Open lesions data:</label> <input type=file id="load_lesions_data" accept="text/csv"></div> -->
            <div><label for="load_task_description">Open task description:</label> <input type=file
                    id="load_task_description" onclick="this.value=null;"></div>
        </div>

        <div id="loader" class="hide">

            <svg version="1.1" id="L3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve">
                <circle fill="none" stroke="#fff" stroke-width="4" cx="50" cy="50" r="44" style="opacity:0.5;" />
                <circle fill="none" stroke="#fff" stroke-width="3" cx="8" cy="54" r="6">
                    <animateTransform attributeName="transform" dur="2s" type="rotate" from="0 50 48" to="360 50 52"
                        repeatCount="indefinite" />

                </circle>
            </svg>

        </div>
    </div>

</body>

</html>